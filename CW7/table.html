
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <title>Make a Table </title>
    <script src="../2ndHomeWork/students.js"></script>
    <script src="table.js"></script>
</head>

<script>
"use strict";
//June 8, 2018 MAE -- basis for 
//https://maeyler.github.io/Visual-Mujam/
//
function makeRows(m, n) {
    let row = "<th></th>";
    for (let j = 1; j <= n; j++) 
        row += "<th>"+j+"</th>";
    let text = "<tr>"+row+"</tr>";
    for (let i = 1; i <= m; i++) {
       row = "<th>"+i+"</th>";
       for (let j = 1; j <= n; j++) {
          const p = n*(i-1)+j;
          const s = "<span class=tip>C"+p+"</span>"
          row += "<td>"+i+","+j+s+"</td>";
       }
       text += "<tr>"+row+"</tr>";
    }
    const t = text.length+" chars";
    console.log("makeRows: "+m+"x"+n+" "+t);
    tablo.innerHTML = text; out.innerText = t; 
}
function tableFromMenu() {
    const a = size.value.split("x");
    makeRows(a[0], a[1]);
    rows.value = a[0];
    cols.value = a[1];
}
function tableFromInput() {
    const m = rows.value;
    const n = cols.value;
    makeRows(m, n);
    size.value = m+"x"+n;
}
var database = new Database()
const ids = []
var fields = [];
const url = "https://maeyler.github.io/JS/data/";
function readData(file) {
    console.log("readData "+file);
    fetch(url+file)
        .then(function(value){return value.text()}, report)
        .then(addStudents, report);
}
function addStudents(txt) {
    let msg = txt.length+" chars, ";
    let a = txt.split("\n");
    msg += a.length+" lines, ";
    for (let s of a) {
      let std = parseStudent(s);
      let stu = new Student(std[0],std[1],std[2],std[3])
      fields.push(stu)
      database.addStudent(std[0],stu)
    }
}
function parseStudent(line) {
    let b = line.split("\t");
    let id = b[0], name = b[1], gpa = b[2];
    let list = [];
    for (let i=3; i<b.length; i++) 
        list.push(database.courses.get(b[i]));
    return [id, name, gpa, list];
}
function report(msg, id, list) {
    out.innerHTML += "<br>"; msg += " ";
    out.appendChild(document.createTextNode(msg));
    let n1;
    if (id) {
        n1 = document.createElement("span");
        n1.appendChild(document.createTextNode(id));
        n1.classList.add("link");
        out.appendChild(n1); msg += id;
        //n1.addEventListener("click", doClick);
    }
    if (list) {
        let n2 = document.createElement("span");
        n2.appendChild(document.createTextNode(""));
        n2.innerHTML += list.join("<br>");
        n2.classList.add("course");
        if (n1) n1.appendChild(n2);
    }
    console.log(msg);
}
function parseCourse(line) {
    let b = line.split("\t");
    let name = b[0], time = b[1], date = b[2];
    let classes = [];
    for (let i=3; i<b.length; i++) 
        classes.push(b[i]);
    return [name, time, date, classes];
}
function addCourses(txt) {
    let a = txt.split("\n");
    for (let s of a) {
      let crs = parseCourse(s);
      let cor = new Course(crs[0],crs[1],crs[2],crs[3])
      database.addCourse(crs[0], cor)
    }
}
function readCourses(file) {
    console.log("readData "+file);
    fetch(url+file)
        .then(r => r.text(), report)
        .then(addCourses, report);
    return database;
}
  readData("Students.txt");
</script>

<style>
    table { border-collapse: collapse; }
    th { color: blue; padding: 5px 5px; }
    td { 
        border: 1px solid blue; 
        padding: 5px 5px; 
        text-align: center; 
    }
    td:hover .tip { visibility: visible; }
    .tip {
        visibility: hidden;
        font-size: small;
        background-color: blue;
        color: white;
        text-align: center;
        padding: 5px 5px;
        position: absolute;
    }
</style>

<body>
<center>
<h2 id=title></h2>

<p>Size: 
<select id="size" oninput="tableFromMenu()">
    <option selected>3x5</option>
    <option>5x5</option>
    <option>7x8</option>
    <option>9x9</option>
</select></p>

<table id="tablo"></table>

<p id=out style="font-size:small"></p>

<form oninput="tableFromInput()">
  Rows: 
  <input type=number id=rows style="width:40px" value=7>
  Columns: 
  <input type=number id=cols style="width:40px" value=8>
  <br><br>
  <input type=reset>
  <input type=button value="Make Table" onclick="tableFromInput()">
</form>
</center>

<hr />
<b>Sample code</b>
<pre id=sample></pre>
<hr />

<script>
    title.innerText = document.title;
    sample.innerText = makeRows.toString();
    makeRows(3, 5);
</script>

</body>
</html> 

  
